<div class="project-details" *ngIf="project">
  <!-- Project Header -->
  <div class="project-header">
    <h1>{{ project.projectName }}</h1>
    <p class="project-description">{{ project.projectDescription }}</p>
  </div>

  <!-- Project Summary -->
  <div class="project-summary">
    <div class="summary-item">
      <span class="label">Total Tasks:</span>
      <span class="value">{{ project.tasks?.length || 0 }}</span>
    </div>
  </div>

  <!-- Task Status Chart -->
  <div class="chart-section" *ngIf="project.tasks && project.tasks.length > 0">
    <h3>Task Status Overview</h3>
    <div class="chart-container">
      <div class="pie-chart">
        <svg width="200" height="200" viewBox="0 0 200 200">
          <!-- Not Started Slice -->
          <circle
            cx="100"
            cy="100"
            r="80"
            fill="transparent"
            stroke="#ffeaa7"
            stroke-width="40"
            [attr.stroke-dasharray]="
              getNotStartedArc() + ' ' + (502 - getNotStartedArc())
            "
            stroke-dashoffset="125.5"
            transform="rotate(-90 100 100)"
          ></circle>
          <!-- In Progress Slice -->
          <circle
            cx="100"
            cy="100"
            r="80"
            fill="transparent"
            stroke="#74b9ff"
            stroke-width="40"
            [attr.stroke-dasharray]="
              getInProgressArc() + ' ' + (502 - getInProgressArc())
            "
            [attr.stroke-dashoffset]="125.5 - getNotStartedArc()"
            transform="rotate(-90 100 100)"
          ></circle>
          <!-- Completed Slice -->
          <circle
            cx="100"
            cy="100"
            r="80"
            fill="transparent"
            stroke="#00b894"
            stroke-width="40"
            [attr.stroke-dasharray]="
              getCompletedArc() + ' ' + (502 - getCompletedArc())
            "
            [attr.stroke-dashoffset]="
              125.5 - getNotStartedArc() - getInProgressArc()
            "
            transform="rotate(-90 100 100)"
          ></circle>
        </svg>
        <div class="chart-center">
          <span class="chart-total">{{ project.tasks?.length || 0 }}</span>
          <span class="chart-label">Tasks</span>
        </div>
      </div>
      <div class="chart-legend">
        <div class="legend-item">
          <div class="legend-color not-started"></div>
          <span class="legend-text"
            >Not Started ({{ getStatusCount("not-started") }})</span
          >
        </div>
        <div class="legend-item">
          <div class="legend-color in-progress"></div>
          <span class="legend-text"
            >In Progress ({{ getStatusCount("in-progress") }})</span
          >
        </div>
        <div class="legend-item">
          <div class="legend-color completed"></div>
          <span class="legend-text"
            >Completed ({{ getStatusCount("completed") }})</span
          >
        </div>
      </div>
    </div>
  </div>

  <!-- Tasks Section -->
  <div class="tasks-section">
    <h2>Tasks</h2>

    <div class="tasks-list" *ngIf="project.tasks && project.tasks.length > 0">
      <div class="task-item" *ngFor="let task of project.tasks">
        <div class="task-header">
          <h3 class="task-name-link" (click)="navigateToTask(task)">
            {{ task.taskName }}
          </h3>
          <div class="task-meta">
            <div class="task-badges">
              <span class="status-badge" [class]="'status-' + task.status">{{
                task.status
              }}</span>
              <span
                class="priority-badge"
                [class]="'priority-' + task.priority"
                >{{ task.priority }}</span
              >
            </div>
            <div class="task-actions">
              <button
                class="action-btn edit-btn"
                (click)="editTask(task)"
                title="Edit Task"
              >
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"
                  ></path>
                  <path
                    d="m18.5 2.5 a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"
                  ></path>
                </svg>
              </button>
              <button
                class="action-btn delete-btn"
                (click)="deleteTask(task)"
                title="Delete Task"
              >
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <polyline points="3,6 5,6 21,6"></polyline>
                  <path
                    d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"
                  ></path>
                  <line x1="10" y1="11" x2="10" y2="17"></line>
                  <line x1="14" y1="11" x2="14" y2="17"></line>
                </svg>
              </button>
            </div>
          </div>
        </div>
        <p class="task-description">{{ task.taskDescription }}</p>
      </div>
    </div>

    <div class="no-tasks" *ngIf="!project.tasks || project.tasks.length === 0">
      <p>No tasks available for this project.</p>
    </div>
  </div>
</div>

<div class="no-project" *ngIf="!project">
  <p>Project not found.</p>
</div>
